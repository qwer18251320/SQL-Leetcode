#####     äºŒåˆ·     #####
ðŸ“Œ 181. Employees Earning More Than Their Managers
Write an SQL query to find the employees who earn more than their managers.

â€¢ SQL (e1, e2)
Select e2.name As employee
From Employee e1, Employee e2
Where e1.id = e2.managerId
And e2.salary>e1.salary

â€¢ SQL (Join)
Select e2.name As employee
From Employee e1 Join Employee e2
Where e1.id = e2.managerId
And e2.salary>e1.salary


ðŸ“Œ 182. Duplicate Emails
Write an SQL query to report all the duplicate emails.

â€¢ SQL (General)
Select email
From Person
Group By Email
Having count(*) >1

â€¢ SQL (2 select)
Select email
From (Select email, Count(email) As cnt
From Person
Group By email) As p1
Where cnt>1

â€¢ SQL (Window Function)
With cte As
(Select email, count(email) As cnt
From Person 
Group By email)

Select email As Email
From cte
Where cnt>1


ðŸ“Œ 183. Customers Who Never Order
Write an SQL query to report all customers who never order anything.

â€¢ SQL (Not In)
Select name As Customers
From Customers
Where id Not IN 
(Select Distinct(customerId) As id
From Orders)

â€¢ SQL (Lefty Join & Is Null)
Select name As Customers
From Customers c1 Left Join Orders o1 
On c1.id = o1.customerId
Where o1.customerId is null


ðŸ“Œ 584. Find Customer Referee
Write an SQL query to report the names of the customer that are not referred by the customer with id = 2.

â€¢ SQL (# è§£é¡Œè¦æ³¨æ„null)
Select name
From Customer
Where referee_id != 2 Or referee_id IS NULL

â€¢ SQL (#Not In)
Select name
From Customer
Where id Not In (Select id 
                        From Customer
                        Where referee_id = 2)


ðŸ“Œ 595. Big Countries
A country is big if:
  it has an area of at least three million (i.e., 3000000 km2), or
  it has a population of at least twenty-five million (i.e., 25000000).
Write an SQL query to report the name, population, and area of the big countries.

â€¢ SQL (## é‚„å¯ä»¥ä½¿ç”¨Union)
Select name, population, area
From World
Where area>3000000 
Or population >= 25000000

â€¢ SQL (## é‚„å¯ä»¥ä½¿ç”¨Union)
Select name, population, area
From World WHERE area >3000000
Union
Select name, population, area
From World WHERE population >= 25000000

                        
                        
                        
                        
                        





#####     å°šæœªäºŒåˆ·     #####
ðŸ“Œ 1757. Recyclable and Low Fat Products
Write an SQL query to find the ids of products that are both low fat and recyclable.

â€¢ SQL
Select product_id
From Products
Where low_fats = "Y"
And recyclable = "Y"


ðŸ“Œ 1148. Article Views I
Select Distinct(author_id) As id
From Views v1
Where author_id = viewer_id
Order By id Asc


ðŸ“Œ 620. Not Boring Movies
Select*
From Cinema
Where description != "boring"
And Mod(id,2) != 0
Order By rating Desc

ðŸ“Œ 1407. Top Travellers
# ç”¨Left Join è€Œéžright, å› ç‚ºè¦æ‰€æœ‰äººçš„åå­—éƒ½æœ‰ï¼Œå¯èƒ½æœ‰äººæ²’æœ‰æ—…è¡Œ
Select name, Ifnull(Sum(distance),0) As travelled_distance 
From Users u1 Left Join Rides r1 
On u1.id = r1.user_id
Group By user_id
Order By travelled_distance Desc, name ASC


ðŸ“Œ 1693. Daily Leads and Partners
Select date_id, make_name, Count(Distinct lead_id) As unique_leads, 
Count(Distinct partner_id) As unique_partners
From DailySales
Group By date_id, make_name



ðŸ“Œ 1741. Find Total Time Spent by Each Employee
Select event_day As day, emp_id, Sum(out_time-in_time) As total_time
From Employees
Group By event_day, emp_id


ðŸ“Œ 1587. Bank Account Summary II
â€¢ Windown Function
With cte As
(Select name, Sum(amount) As balance
From Users u1 Right Join Transactions t1 Using(account)
Group By t1.account)

Select* 
From cte
Where balance>10000

â€¢ Regular
Select name, Sum(amount) As balance
From Users u1 Right Join Transactions t1 Using(account)
Group By t1.account
Having Sum(amount)>10000


ðŸ“Œ 1729. Find Followers Count
Select user_id, Count(Distinct follower_id) As followers_count
From Followers
Group By user_id
Order By user_id





#####     ä»¥ä¸‹ç‚ºé¡žä¼¼é¡Œåž‹(å°šæœªäºŒåˆ·)     #####
ðŸ“Œ 586. Customer Placing the Largest Number of Orders
Write an SQL query to find the customer_number for the customer who has placed the largest number of orders.
â€¢ SQL
Select customer_number
From Orders
Group By customer_number
Having Count(order_number) 
Order By Count(order_number) DESC
Limit 1

â€¢ SQL - ç°¡åŒ–ç‰ˆ
Select customer_number
From Orders
Group By customer_number
Order By Count(*) DESC
Limit 1



ðŸ“Œ 596. Classes More Than 5 Students
Write an SQL query to report all the classes that have at least five students.
â€¢ SQL
Select class 
From (Select class, Count(Distinct student) As cnt
      From courses
      Group By class) c1
Where cnt >=5






# Early Date #

ðŸ“Œ 511. Game Play Analysis I
Write an SQL query to report the first login date for each player.
â€¢ SQL
Select player_id, Min(event_date) As first_login
From Activity
Group By player_id


ðŸ“Œ 175. Combine Two Tables
è§£æ³•1. Using
Select firstName, lastName, IfNull(city, null) As city, Ifnull(state, null) As state
From Person p1 Left Join Address a1 Using(personId)

è§£æ³•2. On
Select firstName, lastName, IfNull(city, null) As city, Ifnull(state, null) As state
From Person p1 Left Join Address a1 Using(personId)


ðŸ“Œ 619. Biggest Single Number
è§£æ³• 1.
Select Max(num) As num
From (
Select num, Count(*) As cnt
From MyNumbers
Group By num) As m1
Where cnt=1

è§£æ³• 2. 
é‚„å¯ä»¥å¯«æˆ cte, æˆ–è€…æ˜¯Having count(num)=1

ðŸ“Œ 1068. Product Sales Analysis I
è§£æ³• 1. 
Select product_name, year, price
From Sales s1 Left Join Product p1
Using (product_id)

è§£æ³• 2. window function
é‚„æ²’å¯«


ðŸ“Œ 1069. Product Sales Analysis II
è§£æ³• 1.
Select product_id, sum(quantity) As total_quantity
From Sales s1 
Group By product_id

è§£æ³• 2. window function
é‚„æ²’å¯«


ðŸ“Œ 1075. Project Employees I
è§£æ³• 1. 
Select project_id, Round(Avg(experience_years),2) As average_years
From Project p1 Left Join Employee e1
Using (employee_id)
Group By project_id

è§£æ³• 2. window function
With cte As
(Select* From Project p1 Join Employee e1 Using(employee_id))

Select project_id, Round(Avg(experience_years),2) As average_years
From cte
Group By project_id
Order By project_id;


ðŸ“Œ 2329. Product Sales Analysis V
è§£æ³• 1.
Select user_id, Sum(quantity*price) As spending
From Sales s1 Left Join Product p1
Using(product_id)
Group By user_id
Order By spending DESC, user_id ASC

çœ‹çœ‹æœ‰æ²’æœ‰è§£æ³•2. 
 

ðŸ“Œ  2082. The Number of Rich Customers
è§£æ³• 1.
Select Count(Distinct customer_id) As rich_count
From Store
Where amount > 500

çœ‹çœ‹æœ‰æ²’æœ‰è§£æ³•2. 



ðŸ“Œ 1821. Find Customers With Positive Revenue this Year
Select customer_id
From Customers
Where year=2021
Group By customer_id
Having Sum(revenue)>0
