📌 1757. Recyclable and Low Fat Products
Write an SQL query to find the ids of products that are both low fat and recyclable.

• SQL
Select product_id
From Products
Where low_fats = "Y"
And recyclable = "Y"


📌 1148. Article Views I
Select Distinct(author_id) As id
From Views v1
Where author_id = viewer_id
Order By id Asc


📌 620. Not Boring Movies
Select*
From Cinema
Where description != "boring"
And Mod(id,2) != 0
Order By rating Desc

📌 1407. Top Travellers
# 用Left Join 而非right, 因為要所有人的名字都有，可能有人沒有旅行
Select name, Ifnull(Sum(distance),0) As travelled_distance 
From Users u1 Left Join Rides r1 
On u1.id = r1.user_id
Group By user_id
Order By travelled_distance Desc, name ASC


📌 1693. Daily Leads and Partners
Select date_id, make_name, Count(Distinct lead_id) As unique_leads, 
Count(Distinct partner_id) As unique_partners
From DailySales
Group By date_id, make_name



📌 1741. Find Total Time Spent by Each Employee
Select event_day As day, emp_id, Sum(out_time-in_time) As total_time
From Employees
Group By event_day, emp_id


📌 1587. Bank Account Summary II
• Windown Function
With cte As
(Select name, Sum(amount) As balance
From Users u1 Right Join Transactions t1 Using(account)
Group By t1.account)

Select* 
From cte
Where balance>10000

• Regular
Select name, Sum(amount) As balance
From Users u1 Right Join Transactions t1 Using(account)
Group By t1.account
Having Sum(amount)>10000




# 以下為類似題型

📌 586. Customer Placing the Largest Number of Orders
Write an SQL query to find the customer_number for the customer who has placed the largest number of orders.
• SQL
Select customer_number
From Orders
Group By customer_number
Having Count(order_number) 
Order By Count(order_number) DESC
Limit 1

• SQL - 簡化版
Select customer_number
From Orders
Group By customer_number
Order By Count(*) DESC
Limit 1



📌 596. Classes More Than 5 Students
Write an SQL query to report all the classes that have at least five students.
• SQL
Select class 
From (Select class, Count(Distinct student) As cnt
      From courses
      Group By class) c1
Where cnt >=5






# Early Date #

📌 511. Game Play Analysis I
Write an SQL query to report the first login date for each player.
• SQL
Select player_id, Min(event_date) As first_login
From Activity
Group By player_id


📌 175. Combine Two Tables
解法1. Using
Select firstName, lastName, IfNull(city, null) As city, Ifnull(state, null) As state
From Person p1 Left Join Address a1 Using(personId)

解法2. On
Select firstName, lastName, IfNull(city, null) As city, Ifnull(state, null) As state
From Person p1 Left Join Address a1 Using(personId)

