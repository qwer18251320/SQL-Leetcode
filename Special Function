# Delete Function
ðŸ“Œ 196. Delete Duplicate Emails
è§£æ³•1. ä¸€å€‹å¥—ä¸€å€‹
Delete
From Person
Where id NOT IN (Select *
                 From 
                 (Select Min(id)
                From Person p1
                Group By email) as p1)
                
è§£æ³•2. 
Delete p1
From person p1, person p2
Where p1.email=p2.email
And p1.id>p2.id


## Update
ðŸ“Œ 627. Swap Salary
è§£æ³•1. 
Update salary 
Set 
sex = Case Sex
When "m" Then "f"
Else "m" 
End

è§£æ³•2. If function
UPDATE
    salary
SET
    sex = IF(sex = 'm', 'f', 'm');



# String Processing Functions #
ðŸ“Œ 1667. Fix Names in a Table
è§£æ³• 1. Concat(), Upper(), Lower, Length()
Select user_id, concat(Upper(Left(name,1)),Lower(Right(name,Length(name)-1))) As name
From Users
Order By user_id ASC

è§£æ³• 2. Concat(), substring(column,position, #)
Select user_id, concat(Upper(Substring(name,1,1)),Lower(Substring(name,2, Length(name)-1))) As name
From Users
Order By user_id ASC


ðŸ“Œ 1484. Group Sold Products By The Date
è§£æ³• 1. Group_Concat(Distinct column Order By)
Select sell_date, Count(Distinct product) AS num_sold, 
Group_concat(Distinct product 
             Order By product ASC) As products
From Activities a1
Group By sell_date
Order By sell_date ASC





# Union #
ðŸ“Œ 1965. Employees With Missing Information
è§£æ³•1. Union
Select employee_id
From Employees e1 
Where employee_id Not In (Select employee_id From Salaries)
Union
Select employee_id
From Salaries s1
Where employee_id Not In (Select employee_id From Employees)
Order By employee_id ASC

è§£æ³•2. Join & Union
Select e1.employee_id 
From Employees e1 Left Join Salaries s1 
On e1.employee_id = s1.employee_id
Where salary IS NULL
Union
Select s2.employee_id
From Employees e2 Right Join Salaries s2
On e2.employee_id = s2.employee_id
Where name IS NULL
Order By employee_id ASC




#  Window Function #
# Rank #
ðŸ“Œ 176. Second Highest Salary
Select Max(Salary) As SecondHighestSalary
From Employee
Where salary < (Select Max(Salary)
                From Employee) 

Select Max(Salary) As SecondHighestSalary
From Employee
Where Salary not in (Select Max(Salary) From Employee);

With cte As
(Select *, Dense_Rank() Over (Order By Salary Desc) As rnk
From Employee)

Select Max(Salary) As SecondHighestSalary
From cte
Where rnk=2
